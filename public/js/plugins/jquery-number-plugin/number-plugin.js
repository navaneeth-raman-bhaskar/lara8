// Jquery Number Plugin
// https://github.com/customd/jquery-number
!function(t){"use strict";function e(t,e){if(this.createTextRange){var a=this.createTextRange();a.collapse(!0),a.moveStart("character",t),a.moveEnd("character",e-t),a.select()}else this.setSelectionRange&&(this.focus(),this.setSelectionRange(t,e))}function a(t){var e=this.value.length;if(t="start"==t.toLowerCase()?"Start":"End",document.selection){var a,i,n,l=document.selection.createRange();return(a=l.duplicate()).expand("textedit"),a.setEndPoint("EndToEnd",l),n=(i=a.text.length-l.text.length)+l.text.length,"Start"==t?i:n}return void 0!==this["selection"+t]&&(e=this["selection"+t]),e}var i={codes:{188:44,109:45,190:46,191:47,192:96,220:92,222:39,221:93,219:91,173:45,187:61,186:59,189:45,110:46},shifts:{96:"~",49:"!",50:"@",51:"#",52:"$",53:"%",54:"^",55:"&",56:"*",57:"(",48:")",45:"_",61:"+",91:"{",93:"}",92:"|",59:":",39:'"',44:"<",46:">",47:"?"}};t.fn.number=function(n,l,s,r,h){if(r=void 0===r?",":r,l=void 0===l?0:l,h=void 0===h||h,"-"===(s=void 0===s?".":s)||"-"===r)throw new Error("Decimal- and thousand-separator may not be assigned to the key '-'.");var o="\\u"+("0000"+s.charCodeAt(0).toString(16)).slice(-4),c=new RegExp("[^"+o+"0-9-]","g"),u=new RegExp(o,"g");return!0===n?this.is("input:text")?this.on({"keydown.format":function(n){var o=t(this),v=o.data("numFormat"),d=n.keyCode?n.keyCode:n.which,g="",p=a.apply(this,["start"]),m=a.apply(this,["end"]),f="",y=!1;if(i.codes.hasOwnProperty(d)&&(d=i.codes[d]),!n.shiftKey&&d>=65&&90>=d?d+=32:!n.shiftKey&&d>=69&&105>=d?d-=48:n.shiftKey&&i.shifts.hasOwnProperty(d)&&(g=i.shifts[d]),""==g&&(g=String.fromCharCode(d)),8!==d&&g!=s&&!g.match(/[0-9]/)&&!g.match(/[-]/)){var x=n.keyCode?n.keyCode:n.which;if(46==x||8==x||9==x||27==x||13==x||(65==x||82==x)&&!0===(n.ctrlKey||n.metaKey)||(86==x||67==x)&&!0===(n.ctrlKey||n.metaKey)||x>=35&&39>=x)return;return n.preventDefault(),!1}if(g.match(/[-]/)&&(!h||this.value.match(/[-]/)&&(0!=p||m!=this.value.length)||0!=p))return!1;if(0==p&&m==this.value.length||0==o.val()?8===d?(p=m=1,this.value="",v.init=l>0?-1:0,v.c=l>0?-(l+1):0,e.apply(this,[0,0])):g===s?(p=m=1,this.value="0"+s+new Array(l+1).join("0"),v.init=l>0?1:0,v.c=l>0?-(l+1):0):0===this.value.length?(v.init=l>0?-1:0,v.c=l>0?-l:0):g.match(/[0-9]/)&&(v.init=-1,v.c=0):v.c=m-this.value.length,l>0&&g==s&&p==this.value.length-l-1)v.c++,v.init=Math.max(0,v.init),n.preventDefault(),y=this.value.length+v.c;else if(g==s)v.init=Math.max(0,v.init),n.preventDefault();else if(l>0&&8==d&&p==this.value.length-l)n.preventDefault(),v.c--,y=this.value.length+v.c;else if(l>0&&8==d&&p>this.value.length-l){if(""===this.value)return;"0"!=this.value.slice(p-1,p)&&(f=this.value.slice(0,p-1)+"0"+this.value.slice(p),o.val(f.replace(c,"").replace(u,s))),n.preventDefault(),v.c--,y=this.value.length+v.c}else 8==d&&this.value.slice(p-1,p)==r?(n.preventDefault(),v.c--,y=this.value.length+v.c):l>0&&p==m&&this.value.length>l+1&&p>this.value.length-l-1&&isFinite(+g)&&!n.metaKey&&!n.ctrlKey&&!n.altKey&&1===g.length&&(f=m===this.value.length?this.value.slice(0,p-1):this.value.slice(0,p)+this.value.slice(p+1),this.value=f,y=p);!1!==y&&e.apply(this,[y,y]),o.data("numFormat",v)},"keyup.format":function(i){var n,s=t(this),r=s.data("numFormat"),h=i.keyCode?i.keyCode:i.which,o=a.apply(this,["start"]);""===this.value||(48>h||h>57)&&(96>h||h>105)&&8!==h||(s.val(s.val()),l>0&&(r.init<1?(o=this.value.length-l-(r.init<0?1:0),r.c=o-this.value.length,r.init=1,s.data("numFormat",r)):o>this.value.length-l&&8!=h&&(r.c++,s.data("numFormat",r))),n=this.value.length+r.c,e.apply(this,[n,n]))},"paste.format":function(e){var a=t(this),i=e.originalEvent,n=null;return window.clipboardData&&window.clipboardData.getData?n=window.clipboardData.getData("Text"):i.clipboardData&&i.clipboardData.getData&&(n=i.clipboardData.getData("text/plain")),a.val(n),e.preventDefault(),!1}}).each(function(){var e=t(this).data("numFormat",{c:-(l+1),decimals:l,thousands_sep:r,dec_point:s,regex_dec_num:c,regex_dec:u,init:!1});""!==this.value&&e.val(e.val())}):this.each(function(){var e=t(this),a=+e.text().replace(c,"").replace(u,".");e.number(isFinite(a)?+a:0,l,s,r)}):this.text(t.number.apply(window,arguments))};var n=null,l=null;t.isPlainObject(t.valHooks.text)?(t.isFunction(t.valHooks.text.get)&&(n=t.valHooks.text.get),t.isFunction(t.valHooks.text.set)&&(l=t.valHooks.text.set)):t.valHooks.text={},t.valHooks.text.get=function(e){var a,i=t(e).data("numFormat");return i?""===e.value?"":(a=+e.value.replace(i.regex_dec_num,"").replace(i.regex_dec,"."),""+(isFinite(a)?a:0)):t.isFunction(n)?n(e):void 0},t.valHooks.text.set=function(e,a){var i=t(e).data("numFormat");return i?e.value=t.number(a,i.decimals,i.dec_point,i.thousands_sep):t.isFunction(l)?l(e,a):void 0},t.number=function(t,e,a,i){i=void 0===i?",":i,a=void 0===a?".":a,e=isFinite(+e)?Math.abs(e):0;var n="\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4),l="\\u"+("0000"+i.charCodeAt(0).toString(16)).slice(-4);t=(t+"").replace(".",a).replace(new RegExp(l,"g"),"").replace(new RegExp(n,"g"),".").replace(new RegExp("[^0-9+-Ee.]","g"),"");var s=isFinite(+t)?+t:0,r="";return(r=(e?function(t,e){var a=Math.pow(10,e);return""+Math.round(t*a)/a}(s,e):""+Math.round(s)).split("."))[0].length>3&&(r[0]=r[0].replace(/\B(?=(?:\d{3})+(?!\d))/g,i)),(r[1]||"").length<e&&(r[1]=r[1]||"",r[1]+=new Array(e-r[1].length+1).join("0")),r.join(a)}}(jQuery);
